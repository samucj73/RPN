<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Calculadora de BF Corporal</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #1f4037, #99f2c8);
      height: 100vh;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      background: #fff;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.3);
      width: 420px;
      text-align: center;
    }
    h1 {
      color: #1f4037;
      margin-bottom: 15px;
    }
    select, input, button {
      margin: 10px 0;
      padding: 10px;
      width: 90%;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 15px;
    }
    button {
      cursor: pointer;
      background: #1f4037;
      color: white;
      border: none;
      transition: 0.3s;
    }
    button:hover {
      background: #14532d;
    }
    #resultado {
      margin-top: 15px;
      font-weight: bold;
      color: #333;
    }
    .card {
      margin-top: 20px;
      padding: 15px;
      border: 2px solid #1f4037;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Calculadora de BF</h1>

    <label for="metodo">Escolha o método:</label>
    <select id="metodo" onchange="mostrarCampos()">
      <option value="">-- Selecione --</option>
      <option value="usnavy">US Navy</option>
      <option value="jackson">Jackson & Pollock (3 pontos)</option>
      <option value="bio">Bioimpedância (estimativa)</option>
    </select>

    <div id="inputs"></div>

    <button onclick="calcular()">Calcular</button>
    <div id="resultado"></div>
    <button onclick="exportarPDF()">Exportar PDF</button>

    <div id="cartao" class="card" style="display:none;"></div>
  </div>

  <!-- Lib para gerar PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    function mostrarCampos() {
      let metodo = document.getElementById("metodo").value;
      let inputsDiv = document.getElementById("inputs");
      inputsDiv.innerHTML = "";

      if (metodo === "usnavy") {
        inputsDiv.innerHTML = `
          <input type="number" id="altura" placeholder="Altura (cm)">
          <input type="number" id="cintura" placeholder="Cintura (cm)">
          <input type="number" id="pescoco" placeholder="Pescoço (cm)">
          <input type="number" id="quadril" placeholder="Quadril (cm) (mulheres)">
          <select id="sexo">
            <option value="homem">Homem</option>
            <option value="mulher">Mulher</option>
          </select>
        `;
      } else if (metodo === "jackson") {
        inputsDiv.innerHTML = `
          <input type="number" id="p1" placeholder="Prega 1 (mm)">
          <input type="number" id="p2" placeholder="Prega 2 (mm)">
          <input type="number" id="p3" placeholder="Prega 3 (mm)">
          <input type="number" id="idade" placeholder="Idade">
          <select id="sexo">
            <option value="homem">Homem</option>
            <option value="mulher">Mulher</option>
          </select>
        `;
      } else if (metodo === "bio") {
        inputsDiv.innerHTML = `
          <input type="number" id="peso" placeholder="Peso (kg)">
          <input type="number" id="bf" placeholder="% BF estimado pela balança">
        `;
      }
    }

    function calcular() {
      let metodo = document.getElementById("metodo").value;
      let resultado = "";

      if (metodo === "usnavy") {
        let altura = parseFloat(document.getElementById("altura").value);
        let cintura = parseFloat(document.getElementById("cintura").value);
        let pescoco = parseFloat(document.getElementById("pescoco").value);
        let quadril = parseFloat(document.getElementById("quadril")?.value || 0);
        let sexo = document.getElementById("sexo").value;

        if (sexo === "homem") {
          resultado = 86.010 * Math.log10(cintura - pescoco) - 70.041 * Math.log10(altura) + 36.76;
        } else {
          resultado = 163.205 * Math.log10(cintura + quadril - pescoco) - 97.684 * Math.log10(altura) - 78.387;
        }
      }
      else if (metodo === "jackson") {
        let p1 = parseFloat(document.getElementById("p1").value);
        let p2 = parseFloat(document.getElementById("p2").value);
        let p3 = parseFloat(document.getElementById("p3").value);
        let idade = parseInt(document.getElementById("idade").value);
        let sexo = document.getElementById("sexo").value;
        let soma = p1 + p2 + p3;
        let dc, bf;

        if (sexo === "homem") {
          dc = 1.10938 - 0.0008267 * soma + 0.0000016 * soma * soma - 0.0002574 * idade;
        } else {
          dc = 1.0994921 - 0.0009929 * soma + 0.0000023 * soma * soma - 0.0001392 * idade;
        }
        resultado = (495 / dc) - 450;
      }
      else if (metodo === "bio") {
        resultado = parseFloat(document.getElementById("bf").value);
      }

      resultado = resultado.toFixed(1);
      document.getElementById("resultado").innerHTML = "Percentual de Gordura: " + resultado + "%";

      let cartao = document.getElementById("cartao");
      cartao.style.display = "block";
      cartao.innerHTML = `
        <h3>Cartão de Avaliação</h3>
        <p><b>Método:</b> ${metodo.toUpperCase()}</p>
        <p><b>Resultado:</b> ${resultado}% de gordura</p>
        <p><b>Data:</b> ${new Date().toLocaleDateString()}</p>
      `;
    }

    function exportarPDF() {
      let { jsPDF } = window.jspdf;
      let doc = new jsPDF();
      let cartao = document.getElementById("cartao").innerText;

      doc.setFont("helvetica", "bold");
      doc.text("Cartão de Avaliação Corporal", 20, 20);
      doc.setFont("helvetica", "normal");
      doc.text(cartao, 20, 40);

      doc.save("avaliacao_bf.pdf");
    }
  </script>
</body>
</html>
