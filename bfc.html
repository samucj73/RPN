<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Calculadora de BF ‚Ä¢ Menu Lateral + PDF</title>
<style>
  :root{
    --bg:#0f1320; --panel:#151b2e; --muted:#a8b3c7; --text:#eaf0ff;
    --pri:#5fe1a1; --pri-2:#76a9ff; --acc:#ffd166; --danger:#ff7b7b;
    --border:rgba(255,255,255,.12); --shadow:0 12px 30px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; display:flex; background:radial-gradient(1200px 800px at -10% -10%, #1e2743 0%, transparent 55%),
    radial-gradient(1000px 700px at 110% 110%, #2a1f48 0%, transparent 55%), var(--bg);
    color:var(--text); font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  }

  /* Sidebar */
  .sidebar{
    width:280px; min-width:240px; padding:22px 16px; border-right:1px solid var(--border);
    background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
    backdrop-filter: blur(6px);
  }
  .brand{display:flex;align-items:center;gap:10px;margin-bottom:18px}
  .logo{
    width:38px; height:38px; border-radius:10px; background:linear-gradient(135deg,var(--pri),var(--pri-2));
    display:grid;place-items:center;font-weight:900;color:#0b0f1a;
  }
  .brand .title{font-weight:800;letter-spacing:.3px}
  .nav{display:grid;gap:8px;margin-top:12px}
  .nav button{
    width:100%; text-align:left; padding:12px 14px; border-radius:10px; border:1px solid var(--border);
    background:rgba(255,255,255,.06); color:var(--text); cursor:pointer; font-weight:600;
    transition:.15s transform,.2s filter;
  }
  .nav button:hover{filter:brightness(1.07)}
  .nav button.active{background:linear-gradient(90deg,var(--pri),var(--pri-2)); color:#0b0f1a; border:none}

  .credits{position:absolute; left:16px; bottom:14px; color:var(--muted); font-size:12px}

  /* Main area */
  .main{flex:1; display:flex; justify-content:center; align-items:flex-start; padding:28px}
  .card{
    width:100%; max-width:860px; background:var(--panel); border:1px solid var(--border);
    border-radius:16px; box-shadow:var(--shadow); padding:22px;
  }
  .header{
    display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between; margin-bottom:12px;
  }
  .header .left{display:flex;gap:10px;align-items:center}
  .h1{font-size:20px; font-weight:800}
  .muted{color:var(--muted); font-size:13px}
  .grid{display:grid; grid-template-columns:1fr 1fr; gap:14px}
  @media (max-width:900px){ .grid{grid-template-columns:1fr} .sidebar{width:220px} }

  .panel{
    background:rgba(255,255,255,.05); border:1px solid var(--border); border-radius:14px; padding:16px;
  }
  .panel h3{margin:0 0 10px 0; font-size:15px}
  label{font-size:13px; color:var(--muted); margin-bottom:4px; display:block}
  input, select{
    width:100%; padding:11px 12px; background:#0e1426; border:1px solid rgba(255,255,255,.14);
    color:var(--text); border-radius:10px; outline:none; font-size:14px;
  }
  input:focus,select:focus{border-color:#7dd3fc; box-shadow:0 0 0 3px rgba(125,211,252,.15)}

  .row{display:grid; grid-template-columns:1fr 1fr; gap:10px}
  .row-3{display:grid; grid-template-columns:repeat(3,1fr); gap:10px}
  @media (max-width:640px){ .row,.row-3{grid-template-columns:1fr} }

  .actions{display:flex;gap:10px;flex-wrap:wrap}
  .btn{
    padding:12px 16px; border-radius:10px; border:1px solid var(--border); cursor:pointer;
    background:linear-gradient(180deg, rgba(255,255,255,.1), rgba(255,255,255,.06)); color:var(--text); font-weight:700;
  }
  .btn-primary{background:linear-gradient(90deg,var(--pri),var(--pri-2)); color:#081018; border:none}
  .btn-ghost{background:rgba(255,255,255,.06)}
  .err{color:var(--danger); font-size:13px}

  .result{
    display:grid; gap:10px; background:rgba(255,255,255,.06); border:1px dashed var(--border);
    border-radius:12px; padding:14px;
  }
  .big{font-size:32px; font-weight:900}
  .badge{display:inline-block; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,.07); border:1px solid var(--border); font-size:12px}

  /* ‚ÄúCart√£ozinho‚Äù para exibi√ß√£o (mesmas propor√ß√µes do PDF) */
  .preview-card{
    width:428px; height:270px; border-radius:14px; border:1px solid var(--border);
    background:linear-gradient(135deg,#111a2e 0%, #172241 55%, #1a1b3e 100%);
    padding:18px; display:grid; grid-template-rows:auto 1fr auto; gap:6px;
  }
  .pc-head{display:flex;justify-content:space-between;align-items:center}
  .pc-logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--pri),var(--acc));display:grid;place-items:center;color:#0b0f1a;font-weight:900}
  .pc-title{font-weight:800;letter-spacing:.3px}
  .pc-body{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .pc-box{background:rgba(255,255,255,.06);border:1px solid var(--border);border-radius:10px;padding:10px}
  .pc-foot{display:flex;justify-content:space-between;color:var(--muted);font-size:12px}
</style>
</head>
<body>

<!-- ===== Sidebar ===== -->
<aside class="sidebar">
  <div class="brand">
    <div class="logo">BF</div>
    <div class="title">Calculadora Corporal</div>
  </div>
  <div class="nav">
    <button class="active" data-target="usnavy" onclick="switchTab(event)">üìè US Navy</button>
    <button data-target="jp3" onclick="switchTab(event)">üìê Jackson & Pollock (3 pts)</button>
    <button data-target="bio" onclick="switchTab(event)">‚ö° Bioimped√¢ncia / IMC</button>
    <button data-target="sobre" onclick="switchTab(event)">‚ÑπÔ∏è Informa√ß√µes</button>
  </div>
  <div class="credits">¬© Seu Projeto ‚Ä¢ uso estimativo</div>
</aside>

<!-- ===== Main ===== -->
<main class="main">
  <div class="card">

    <div class="header">
      <div class="left">
        <div class="h1">Percentual de Gordura (BF)</div>
        <div class="badge" id="metodoBadge">US Navy</div>
      </div>
      <div class="right muted">
        <span>Preencha, calcule e exporte o cart√£o em PDF.</span>
      </div>
    </div>

    <div class="grid">
      <!-- Formul√°rios -->
      <section class="panel" id="form-area">
        <!-- Cabe√ßalho comum -->
        <h3>Dados do Avaliado</h3>
        <div class="row">
          <div>
            <label>Nome</label>
            <input id="nome" placeholder="ex.: Ana Souza" />
          </div>
          <div>
            <label>Data</label>
            <input id="data" type="date" />
          </div>
        </div>

        <!-- ========== US NAVY ========== -->
        <div id="tab-usnavy">
          <div class="row">
            <div>
              <label>Sexo</label>
              <select id="navy-sexo">
                <option value="male">Masculino</option>
                <option value="female">Feminino</option>
              </select>
            </div>
            <div>
              <label>Unidade</label>
              <select id="navy-unid">
                <option value="metric">M√©trico (cm)</option>
                <option value="imperial">Imperial (in)</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div>
              <label>Altura</label>
              <input id="navy-altura" type="number" step="0.1" placeholder="cm ou in" />
            </div>
            <div>
              <label>Pesco√ßo</label>
              <input id="navy-pescoco" type="number" step="0.1" placeholder="cm ou in" />
            </div>
          </div>
          <div class="row">
            <div>
              <label>Cintura</label>
              <input id="navy-cintura" type="number" step="0.1" placeholder="cm ou in" />
            </div>
            <div id="navy-quadril-wrap">
              <label>Quadril (mulheres)</label>
              <input id="navy-quadril" type="number" step="0.1" placeholder="cm ou in" />
            </div>
          </div>
        </div>

        <!-- ========== JACKSON & POLLOCK 3 PONTOS ========== -->
        <div id="tab-jp3" style="display:none">
          <div class="row">
            <div>
              <label>Sexo</label>
              <select id="jp-sexo">
                <option value="male">Masculino</option>
                <option value="female">Feminino</option>
              </select>
            </div>
            <div>
              <label>Idade (anos)</label>
              <input id="jp-idade" type="number" min="10" max="99" />
            </div>
          </div>

          <!-- Homens: t√≥rax, abd√¥men, coxa -->
          <div class="row-3" id="jp-male">
            <div>
              <label>T√≥rax (mm)</label>
              <input id="jp-chest" type="number" step="0.5" />
            </div>
            <div>
              <label>Abd√¥men (mm)</label>
              <input id="jp-abdomen" type="number" step="0.5" />
            </div>
            <div>
              <label>Coxa (mm)</label>
              <input id="jp-thigh" type="number" step="0.5" />
            </div>
          </div>

          <!-- Mulheres: tr√≠ceps, supra-il√≠aca, coxa -->
          <div class="row-3" id="jp-female" style="display:none">
            <div>
              <label>Tr√≠ceps (mm)</label>
              <input id="jp-triceps" type="number" step="0.5" />
            </div>
            <div>
              <label>Supra-il√≠aca (mm)</label>
              <input id="jp-supra" type="number" step="0.5" />
            </div>
            <div>
              <label>Coxa (mm)</label>
              <input id="jp-thigh-f" type="number" step="0.5" />
            </div>
          </div>
          <div class="muted" style="margin-top:6px">Usa densidade corporal (Jackson & Pollock) + f√≥rmula de Siri.</div>
        </div>

        <!-- ========== BIOIMPED√ÇNCIA / IMC ========== -->
        <div id="tab-bio" style="display:none">
          <div class="row">
            <div>
              <label>Sexo</label>
              <select id="bio-sexo">
                <option value="male">Masculino</option>
                <option value="female">Feminino</option>
              </select>
            </div>
            <div>
              <label>Idade (anos)</label>
              <input id="bio-idade" type="number" min="10" max="99" />
            </div>
          </div>
          <div class="row">
            <div>
              <label>Peso (kg)</label>
              <input id="bio-peso" type="number" step="0.1" />
            </div>
            <div>
              <label>Altura (cm)</label>
              <input id="bio-altura" type="number" step="0.1" />
            </div>
          </div>
          <div class="muted">Estimativa baseada em IMC (pr√°tica para comparar com a balan√ßa de bioimped√¢ncia).</div>
        </div>

        <!-- ========== SOBRE ========== -->
        <div id="tab-sobre" style="display:none">
          <p class="muted">
            ‚Ä¢ <b>US Navy</b>: circunfer√™ncias; bom para uso caseiro. <br/>
            ‚Ä¢ <b>Jackson & Pollock (3 pts)</b>: pregas cut√¢neas; requer pr√°tica. <br/>
            ‚Ä¢ <b>Bio/IMC</b>: estimativa r√°pida para refer√™ncia. <br/>
            Esses m√©todos s√£o estimativos e n√£o substituem exames cl√≠nicos (DEXA, BodPod).
          </p>
        </div>

        <div id="form-error" class="err" style="margin-top:6px; display:none">Preencha os campos necess√°rios.</div>
        <div class="actions" style="margin-top:10px">
          <button class="btn btn-primary" onclick="calcular()">Calcular</button>
          <button class="btn btn-ghost" onclick="limpar()">Limpar</button>
        </div>
      </section>

      <!-- Resultado -->
      <section class="panel">
        <h3>Resultado</h3>
        <div class="result">
          <div class="big" id="bf-out">‚Äî</div>
          <div class="badge" id="class-out">‚Äî</div>
          <div class="muted" id="det-out">Escolha o m√©todo, preencha e clique em Calcular.</div>
        </div>

        <h3 style="margin-top:16px">Cart√£o (pr√©-visualiza√ß√£o)</h3>
        <div class="preview-card" id="previewCard">
          <div class="pc-head">
            <div class="pc-logo">BF</div>
            <div class="pc-title">Cart√£o de Avalia√ß√£o Corporal</div>
          </div>
          <div class="pc-body">
            <div class="pc-box">
              <div class="muted">Avaliado</div>
              <div id="pc-nome" style="font-weight:800">‚Äî</div>
              <div class="muted" style="margin-top:6px">M√©todo</div>
              <div id="pc-metodo">‚Äî</div>
            </div>
            <div class="pc-box">
              <div class="muted">% Gordura</div>
              <div id="pc-bf" style="font-size:28px;font-weight:900">‚Äî</div>
              <div class="muted" style="margin-top:6px">Classifica√ß√£o</div>
              <div id="pc-class">‚Äî</div>
            </div>
          </div>
          <div class="pc-foot">
            <div id="pc-data">Data: ‚Äî</div>
            <div id="pc-nota">Ref.: estimativa</div>
          </div>
        </div>

        <div class="actions" style="margin-top:12px">
          <button class="btn btn-primary" onclick="exportPDF()">Exportar PDF (cart√£o 85,6√ó54 mm)</button>
        </div>
      </section>
    </div>
  </div>
</main>

<!-- jsPDF para gerar o PDF do cart√£o -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  // ========= Utilidades =========
  const $ = id => document.getElementById(id);
  const cmToIn = v => v/2.54;

  // Tabs
  function switchTab(ev){
    document.querySelectorAll('.nav button').forEach(b=>b.classList.remove('active'));
    ev.currentTarget.classList.add('active');
    const target = ev.currentTarget.dataset.target;
    // esconder todos
    ['usnavy','jp3','bio','sobre'].forEach(t=>{
      const tab = $('tab-'+t);
      if(tab) tab.style.display = (t===target)?'block':'none';
    });
    // label badge
    const labels = {usnavy:'US Navy', jp3:'Jackson & Pollock (3 pts)', bio:'Bio/IMC', sobre:'Informa√ß√µes'};
    $('metodoBadge').textContent = labels[target] || '‚Äî';
    // mostrar/ocultar campo quadril (US Navy) conforme sexo
    toggleQuadril();
    $('form-error').style.display = 'none';
  }

  function toggleQuadril(){
    const sexo = $('navy-sexo')?.value || 'male';
    $('navy-quadril-wrap').style.display = (sexo==='female') ? 'block' : 'none';
  }
  $('navy-sexo').addEventListener('change', toggleQuadril);

  // Classifica√ß√£o simples por sexo
  function classificar(sexo, bf){
    if(!Number.isFinite(bf)) return '‚Äî';
    if(sexo==='male'){
      if(bf<6) return 'Abaixo do saud√°vel';
      if(bf<=13) return 'Atleta';
      if(bf<=17) return 'Fitness';
      if(bf<=24) return 'Normal';
      return 'Sobrepeso';
    } else {
      if(bf<14) return 'Abaixo do saud√°vel';
      if(bf<=20) return 'Atleta';
      if(bf<=24) return 'Fitness';
      if(bf<=31) return 'Normal';
      return 'Sobrepeso';
    }
  }

  // ========= C√°lculos =========
  function calcUSNavy(){
    const sexo = $('navy-sexo').value;
    const unid = $('navy-unid').value; // metric (cm) ou imperial (in)
    let h = parseFloat($('navy-altura').value);
    let ne = parseFloat($('navy-pescoco').value);
    let wi = parseFloat($('navy-cintura').value);
    let hi = sexo==='female' ? parseFloat($('navy-quadril').value) : 0;

    if([h,ne,wi].some(x => !Number.isFinite(x) || x<=0) || (sexo==='female' && (!Number.isFinite(hi) || hi<=0))){
      return NaN;
    }
    // converter cm -> in se necess√°rio
    if(unid==='metric'){
      h = cmToIn(h); ne = cmToIn(ne); wi = cmToIn(wi); if(sexo==='female') hi = cmToIn(hi);
    }
    if(sexo==='male'){
      const A = wi - ne; if(A<=0) return NaN;
      return 86.010*Math.log10(A) - 70.041*Math.log10(h) + 36.76;
    }else{
      const A = wi + hi - ne; if(A<=0) return NaN;
      return 163.205*Math.log10(A) - 97.684*Math.log10(h) - 78.387;
    }
  }

  function calcJP3(){
    const sexo = $('jp-sexo').value;
    const idade = parseInt($('jp-idade').value);
    if(!Number.isFinite(idade) || idade<=0) return NaN;

    if(sexo==='male'){
      const ch = parseFloat($('jp-chest').value);
      const ab = parseFloat($('jp-abdomen').value);
      const th = parseFloat($('jp-thigh').value);
      if([ch,ab,th].some(x => !Number.isFinite(x) || x<0)) return NaN;
      const S = ch+ab+th;
      const dens = 1.10938 - 0.0008267*S + 0.0000016*S*S - 0.0002574*idade;
      return 495/dens - 450;
    }else{
      const tr = parseFloat($('jp-triceps').value);
      const si = parseFloat($('jp-supra').value);
      const th = parseFloat($('jp-thigh-f').value);
      if([tr,si,th].some(x => !Number.isFinite(x) || x<0)) return NaN;
      const S = tr+si+th;
      const dens = 1.0994921 - 0.0009929*S + 0.0000023*S*S - 0.0001392*idade;
      return 495/dens - 450;
    }
  }

  function calcBioIMC(){
    const sexo = $('bio-sexo').value;
    const idade = parseInt($('bio-idade').value);
    const peso = parseFloat($('bio-peso').value);
    const altura_cm = parseFloat($('bio-altura').value);
    if([idade,peso,altura_cm].some(x => !Number.isFinite(x) || x<=0)) return NaN;
    const h = altura_cm/100;
    const imc = peso/(h*h);
    // Equa√ß√£o de Deurenberg (estimativa r√°pida a partir do IMC)
    const bf = 1.20*imc + 0.23*idade - 10.8*(sexo==='male'?1:0) - 5.4;
    return bf;
  }

  function calcular(){
    const metodo = document.querySelector('.nav button.active')?.dataset.target || 'usnavy';
    let bf = NaN, detalhes = '', sexoForClass = 'male';

    if(metodo==='usnavy'){
      sexoForClass = $('navy-sexo').value;
      bf = calcUSNavy();
      detalhes = 'US Navy: circunfer√™ncias (log10).';
    }else if(metodo==='jp3'){
      sexoForClass = $('jp-sexo').value;
      bf = calcJP3();
      detalhes = 'JP 3 pontos + Siri.';
    }else if(metodo==='bio'){
      sexoForClass = $('bio-sexo').value;
      bf = calcBioIMC();
      detalhes = 'Estimativa via IMC (Deurenberg).';
    }else{
      $('form-error').style.display='block'; return;
    }

    if(!Number.isFinite(bf)){
      $('form-error').style.display='block';
      $('bf-out').textContent='‚Äî'; $('class-out').textContent='‚Äî'; $('det-out').textContent='Verifique os campos.';
      syncPreview();
      return;
    }
    $('form-error').style.display='none';

    // Limites razo√°veis
    if(bf<2) bf=2; if(bf>60) bf=60;

    const classe = classificar(sexoForClass, bf);
    $('bf-out').textContent = bf.toFixed(1)+'%';
    $('class-out').textContent = classe;
    $('det-out').textContent = detalhes;
    syncPreview(); // atualiza cart√£o
  }

  function limpar(){
    document.querySelectorAll('input').forEach(i=>i.value='');
    $('bf-out').textContent='‚Äî'; $('class-out').textContent='‚Äî';
    $('det-out').textContent='Escolha o m√©todo, preencha e clique em Calcular.';
    $('form-error').style.display='none';
    syncPreview();
  }

  // Alternar campos do JP3 por sexo
  $('jp-sexo').addEventListener('change', ()=>{
    const female = $('jp-sexo').value==='female';
    $('jp-male').style.display = female? 'none':'grid';
    $('jp-female').style.display = female? 'grid':'none';
  });

  // Pr√©-preencher data com hoje
  (function initDate(){
    const d = new Date();
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const dd = String(d.getDate()).padStart(2,'0');
    $('data').value = `${yyyy}-${mm}-${dd}`;
  })();

  // Sincroniza o preview do cart√£o
  function syncPreview(){
    const metodo = document.querySelector('.nav button.active')?.textContent.replace(/^[^A-Za-z√Ä-√∫]+/,'') || '‚Äî';
    $('pc-nome').textContent = $('nome').value || '‚Äî';
    $('pc-metodo').textContent = metodo;
    $('pc-data').textContent = 'Data: ' + ($('data').value || '‚Äî');
    $('pc-bf').textContent = $('bf-out').textContent || '‚Äî';
    $('pc-class').textContent = $('class-out').textContent || '‚Äî';
  }

  // Exporta PDF no tamanho cart√£o (85,6 x 54 mm)
  function exportPDF(){
    const { jsPDF } = window.jspdf;
    // formato custom: [altura, largura] em mm -> usaremos paisagem para 85.6x54
    const doc = new jsPDF({orientation:'landscape', unit:'mm', format:[54, 85.6]});

    // Fundo
    doc.setFillColor(18, 26, 48); // #121a30
    doc.roundedRect(0, 0, 85.6, 54, 3, 3, 'F');

    // Header ‚Äúlogo‚Äù
    doc.setFillColor(95, 225, 161); // var(--pri)
    doc.roundedRect(4, 4, 12, 12, 2, 2, 'F');
    doc.setTextColor(11,16,26);
    doc.setFont('helvetica','bold'); doc.setFontSize(10);
    doc.text('BF', 7.9, 12);

    // T√≠tulo
    doc.setTextColor(234,240,255);
    doc.setFontSize(11);
    doc.text('Cart√£o de Avalia√ß√£o Corporal', 20, 11);

    // Linha
    doc.setDrawColor(120,140,180);
    doc.line(4, 16, 81.6, 16);

    // Bloco esquerdo (Nome + M√©todo)
    const nome = $('nome').value || '‚Äî';
    const metodo = $('metodoBadge').textContent || '‚Äî';
    doc.setFontSize(8); doc.setTextColor(168,179,199);
    doc.text('Avaliado', 6, 23);
    doc.setTextColor(234,240,255); doc.setFontSize(10); doc.setFont('helvetica','bold');
    doc.text(nome, 6, 28);

    doc.setTextColor(168,179,199); doc.setFont('helvetica','normal'); doc.setFontSize(8);
    doc.text('M√©todo', 6, 36);
    doc.setTextColor(234,240,255); doc.setFont('helvetica','bold'); doc.setFontSize(10);
    doc.text(metodo, 6, 41);

    // Bloco direito (% e Classifica√ß√£o)
    const bfTxt = ($('bf-out').textContent || '‚Äî').replace('%','');
    const classe = $('class-out').textContent || '‚Äî';
    doc.setTextColor(168,179,199); doc.setFont('helvetica','normal'); doc.setFontSize(8);
    doc.text('% Gordura', 56, 23);
    doc.setTextColor(234,240,255); doc.setFont('helvetica','bold'); doc.setFontSize(20);
    doc.text(isNaN(parseFloat(bfTxt)) ? '‚Äî' : (parseFloat(bfTxt).toFixed(1)+'%'), 56, 31);

    doc.setTextColor(168,179,199); doc.setFont('helvetica','normal'); doc.setFontSize(8);
    doc.text('Classifica√ß√£o', 56, 38);
    doc.setTextColor(234,240,255); doc.setFont('helvetica','bold'); doc.setFontSize(10);
    // Quebra se longo
    const classeLines = doc.splitTextToSize(classe, 25);
    doc.text(classeLines, 56, 43);

    // Rodap√©
    const data = $('data').value ? $('data').value.split('-').reverse().join('/') : '‚Äî';
    doc.setTextColor(168,179,199); doc.setFont('helvetica','normal'); doc.setFontSize(8);
    doc.text('Data: '+data, 6, 51);
    doc.text('Ref.: estimativa ‚Ä¢ n√£o substitui exames cl√≠nicos', 39, 51, {align:'right'});

    doc.save('cartao-bf.pdf');
  }

  // Atualiza preview quando dados mudam
  ['nome','data'].forEach(id=>$(id).addEventListener('input', syncPreview));
</script>
</body>
</html>
